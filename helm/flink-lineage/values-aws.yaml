# AWS values for EKS + MSK (TLS) + S3

flinkImage:
  repository: "605618833247.dkr.ecr.us-east-1.amazonaws.com/flink-lineage"
  pullPolicy: Always

dataGenerator:
  image:
    repository: "605618833247.dkr.ecr.us-east-1.amazonaws.com/flink-lineage-data-generator"
    pullPolicy: Always
  env:
    KAFKA_BOOTSTRAP_SERVERS: "b-2.maitmskcluster.2ndhjy.c20.kafka.us-east-1.amazonaws.com:9094,b-1.maitmskcluster.2ndhjy.c20.kafka.us-east-1.amazonaws.com:9094"
    KAFKA_SECURITY_PROTOCOL: "SSL"

# IRSA â€” S3 access via flink-workload IAM role
serviceAccount:
  name: "flink-workload"
  annotations:
    eks.amazonaws.com/role-arn: "arn:aws:iam::605618833247:role/mait_flink_workload_role-2860d09"

flink:
  env:
    KAFKA_BOOTSTRAP_SERVERS: "b-2.maitmskcluster.2ndhjy.c20.kafka.us-east-1.amazonaws.com:9094,b-1.maitmskcluster.2ndhjy.c20.kafka.us-east-1.amazonaws.com:9094"
    KAFKA_TOPIC: "lineage-input"
    KAFKA_SECURITY_PROTOCOL: "SSL"
    OUTPUT_PATH: "s3://flink-data-outputs/output"
    WRITE_AHEAD_COMMIT_LOG_PATH: "s3://flink-commit-log/write-ahead-commit-log"
    DROPPED_PATH: "s3://flink-data-outputs/dropped"

  s3Configuration:
    s3.path-style-access: "false"
    fs.s3a.aws.credentials.provider: "com.amazonaws.auth.WebIdentityTokenCredentialsProvider"

  flinkConfiguration:
    state.checkpoints.dir: s3://flink-data-outputs/checkpoints
    state.savepoints.dir: s3://flink-data-outputs/savepoints

  jobManager:
    resource:
      memory: "2048m"

  taskManager:
    resource:
      memory: "4096m"
      cpu: 1

  job:
    parallelism: 4
    upgradeMode: savepoint
